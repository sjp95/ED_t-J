#ifndef POB_HPP_INCLUDED
#define POB_HPP_INCLUDED
#include <math.h>
#include <complex>
#include <Eigen/Dense>
#include <vector>
#include <omp.h>
#include "input.hpp"
using namespace std;
using namespace Eigen;
//================================================================================//
//================================================================================//

//=========================================================//
//=========================================================//
long long input::fact(long long n)
{
  if (n == 0 || n == 1)
  return 1;
  else
  return n * fact(n - 1);
}
//=========================================================//
long long input:: nCr(long long n,long long r)
{
  if(n>=r)
  {
      return fact(n) / (fact(r) * fact(n - r));
  }
  else
  {
      return 0;
  }
}
//=========================================================//
//=========================================================//


//================================================================================//
                                   //== POB for Up ==//
//================================================================================//


//==============================================//
                //== POB number ==//
//==============================================//
void input::pob_up_n(int value)
{
    int j=N;
    int temp= value;
    upi=VectorXi ::Zero(N);
    
    for(int k=nup;k>=1;k-=1)
    {
      //==========step-1==========//
        do      
        {
          j=j-1;
          int p= nCr(j,k);
          
          if (temp>=p)
          {
            temp = temp-p;
            upi(j) = 1;
          }
          else
          {
            upi(j)=0;
          }

        } while (j>0 && upi(j)!=1);
    }
    //==========step-2==========//
    if (j >= 0)
    for(int k=j-1;k>=0;k=k-1)
    {
      upi(k)=0;
    }
    //===========================//
  //return upi;
}
//=========================================================//
//=========================================================//

//=================================================================================//
//=================================================================================//

//==============================================//
                //== POB values ==//
//==============================================//
int input::pob_up_v()
{
  int V=0;
  for(int i=0;i<upi.size();i++)
  {
    int alp=0;
    if(upi(i)>0)
    {
      for (int j = 0; j <=i; j++)
      {
        alp+=upi(j);
      }
      V+=upi(i)*nCr(i,alp);
    }
  }

  return V;
}
//=========================================================//
//=========================================================//



//================================================================================//
                                //== POB for down ==//
//================================================================================//



//==============================================//
                //== POB number ==//
//==============================================//
void input::pob_down_n(int value)
{
    int j=N;
    int temp= value;
    downi=VectorXi ::Zero(N);
    
    for(int k=ndown;k>=1;k-=1)
    {
      //==========step-1==========//
        do      
        {
          j=j-1;
          int p= nCr(j,k);
          
          if (temp>=p)
          {
            temp = temp-p;
            downi(j) = 1;
          }
          else
          {
            downi(j)=0;
          }

        } while (j>0 && downi(j)!=1);
    }
    //==========step-2==========//
    if (j >= 0)
    for(int k=j-1;k>=0;k=k-1)
    {
      downi(k)=0;
    }
    //===========================//
  //return downi;
}
//=========================================================//
//=========================================================//




//==============================================//
                //== POB values ==//
//==============================================//
int input:: pob_down_v()
{
  int V=0;
  for(int i=0;i<downi.size();i++)
  {
    int alp=0;
    if(downi(i)>0)
    {
      for (int j = 0; j <=i; j++)
      {
        alp+=downi(j);
      }
      V+=downi(i)*nCr(i,alp);
    }
  }

  return V;
}
//=========================================================//
//=========================================================//


//================================================================================//
//================================================================================//
#endif
